if(process.argv.length !== 4){
	console.log("Check Command Arguments...");
	console.log("Usage: node pos2csv.js input.pos output.csv");
	process.exit(1);
}

var input=process.argv[2];
var output=process.argv[3];

var outputString = '"Designator","NozzleNum","StackNum","Mid X","Mid Y","Rotation","Height","Speed","Vision","Pressure","Explanation"\r\n';
outputString += '""\r\n';

var outputFooter = "";


var lineReader = require('readline').createInterface({
  input: require('fs').createReadStream(input)
});

lineReader.on('line', function (line) {
	outputString += processLine(line);
});

lineReader.on('close', function (){
	outputString += outputFooterdata();
	
	console.log(outputString);
});


function processLine(line){
	if(line.lastIndexOf('#', 0) !== 0){
		while(line.indexOf("  ") > -1){
			line = line.replace("  ", " ");
		}		
		return formatCSV(line.split(" "))  + "\r\n";
	} else 
		return '';
}

function formatCSV(details){
	var columnIndex = {
		Ref		: 0,
		Val		: 1,
		Package	: 2,
		PosX	: 3,
		PosY	: 4,
		Rot		: 5,
		Side	: 6
		
	};
	
	var result = "";
	result += '"'+details[columnIndex.Ref] + '",'; 		// Designator
	result += '"1",';									// NozzleNum
	result += '"L1",';									// StackNum
	result += '"'+details[columnIndex.PosX] + '",';		// Mid X
	result += '"'+details[columnIndex.PosY] + '",';		// Mid Y
	result += '"'+details[columnIndex.Rot] + '",';		// Rotation
	result += '"0.00",';								// Height
	result += '"100",';									// Speed
	result += '"None",';								// Vision
	result += '"True",';								// Pressure
	result += '"'+details[columnIndex.Val] + '"';		// Explanation


	return result;
}

function outputFooterdata(){
	var result = '';
	result += '\r\nPuzzle';
	result += '\r\n76.47';
	result += '\r\n31.78';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n74.03';
	result += '\r\n119.11';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n110.00';
	result += '\r\n110.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n-50.00';
	result += '\r\n-50.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n73.92';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n30.15';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n72.82';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\n31.07';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n0.00';
	result += '\r\n';
	result += '\r\nOther';
	result += '\r\n1.20';
	result += '\r\n';
	result += '\r\nTrue';
	result += '\r\nTrue';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\n';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\nFalse';
	result += '\r\n';
	result += '\r\nMark';
	result += '\r\n1';
	result += '\r\n0';
	result += '\r\nFalse';
	result += '\r\n11';
	result += '\r\n';
	return result;
}



